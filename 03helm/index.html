<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>03 Helm 패키지 매니저 - 쿠버네티스 중급</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="generator" content="mkdocs-1.1.2, mkdocs-gitbook-1.0.7">

<link rel="shortcut icon" href="../images/favicon.ico" type="image/x-icon">
<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta rel="next" href="" />
<link href="../css/style.min.css" rel="stylesheet"> 
</head>

<body>
<div class="book">
<div class="book-summary">

<nav role="navigation">
<ul class="summary">
<li>
<a href=".." target="_blank" class="custom-link">쿠버네티스 중급</a>
</li>
<li class="divider"></li>
<li class="chapter" data-path="01overview/">
<a href="../01overview/">01 Overview</a>
<li class="chapter" data-path="02kubespray/">
<a href="../02kubespray/">02 Kubespray</a>
<li class="chapter active" data-path="03helm/">
<a href="./">03 Helm 패키지 매니저</a>
<li class="chapter" data-path="04ingress/">
<a href="../04ingress/">04 Ingress</a>
<li class="chapter" data-path="05storage/">
<a href="../05storage/">05 스토리지</a>
<li class="chapter" data-path="06scheduling/">
<a href="../06scheduling/">06 고급 스케줄링</a>
<li class="chapter" data-path="07resource-mgt/">
<a href="../07resource-mgt/">07 리소스 관리</a>
<li class="chapter" data-path="08access-control/">
<a href="../08access-control/">08 접근제어</a>
<li class="chapter" data-path="09crd/">
<a href="../09crd/">09 사용자정의 리소스</a>
<li class="chapter" data-path="10log-mon/">
<a href="../10log-mon/">10 로깅 & 모니터링</a>
<li class="chapter" data-path="11cicd/">
<a href="../11cicd/">11 CI / CD</a>
<li class="chapter" data-path="12workflow/">
<a href="../12workflow/">12 워크플로우 관리</a>
<li class="divider"></li>



<li><a href="http://www.mkdocs.org">
Published with MkDocs
</a></li>

<li><a href="https://github.com/GitbookIO/theme-default">
Theme by GitBook
</a></li>
</ul>

</nav>

</div> <!-- end of book-summary -->

<div class="book-body">
<div class="body-inner">
<div class="book-header" role="navigation">

<!-- Title -->
<h1>
<i class="fa fa-circle-o-notch fa-spin"></i>
<a href="." ></a>
</h1>

</div> <!-- end of book-header -->

<div class="page-wrapper" tabindex="-1" role="main">
<div class="page-inner">

<section class="normal markdown-section">



<h1 id="03-helm">03장 Helm 패키지매니저<a class="headerlink" href="#03-helm" title="Permanent link">&para;</a></h1>
<h3 id="helm">helm 설치<a class="headerlink" href="#helm" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>curl https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 <span class="p">|</span> bash
</code></pre></div>
<h3 id="helm-chart">helm chart 생성<a class="headerlink" href="#helm-chart" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Creating mychart</span>
helm create mychart

ls mychart
<span class="c1"># Chart.yaml  charts  templates  values.yaml</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>ls mychart/templates
<span class="c1"># NOTES.txt  _helpers.tpl  deployment.yaml  hpa.yaml  ingress.yaml  service.yaml  serviceaccount.yaml  tests</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># mychart/templates/service.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="p p-Indicator">{{</span> <span class="nv">include &quot;mychart.fullname&quot; .</span> <span class="p p-Indicator">}}</span>
  <span class="nt">labels</span><span class="p">:</span>
    <span class="p p-Indicator">{{</span><span class="nv">- include &quot;mychart.labels&quot; . | nindent 4</span> <span class="p p-Indicator">}}</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="p p-Indicator">{{</span> <span class="nv">.Values.service.type</span> <span class="p p-Indicator">}}</span>         <span class="c1"># 서비스 타입 지정</span>
  <span class="nt">ports</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">port</span><span class="p">:</span> <span class="p p-Indicator">{{</span> <span class="nv">.Values.service.port</span> <span class="p p-Indicator">}}</span>     <span class="c1"># 서비스 포트 지정</span>
      <span class="nt">targetPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
      <span class="nt">protocol</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">TCP</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="p p-Indicator">{{</span><span class="nv">- include &quot;mychart.selectorLabels&quot; . | nindent 4</span> <span class="p p-Indicator">}}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>helm install foo ./mychart
</code></pre></div>
<div class="highlight"><pre><span></span><code>helm list

helm list -n kube-system
</code></pre></div>
<div class="highlight"><pre><span></span><code>helm template foo ./mychart &gt; foo-output.yaml

cat foo-output.yaml
</code></pre></div>
<div class="highlight"><pre><span></span><code>kubectl get svc
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># mychart/values.yaml</span>
<span class="nn">...</span>

<span class="nt">service</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">NodePort</span>    <span class="c1"># 기존 ClusterIP</span>
  <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>        
<span class="nn">...</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>helm upgrade foo ./mychart

kubectl get svc

helm list
</code></pre></div>
<div class="highlight"><pre><span></span><code>helm status foo
</code></pre></div>
<div class="highlight"><pre><span></span><code>helm delete foo

helm list
</code></pre></div>
<h3 id="helm-repository">helm repository<a class="headerlink" href="#helm-repository" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>helm repo add bitnami https://charts.bitnami.com/bitnami
helm repo update
helm repo list
</code></pre></div>
<div class="highlight"><pre><span></span><code>helm search repo bitnami

helm search repo bitnami/airflow
</code></pre></div>
<div class="highlight"><pre><span></span><code>helm install mynginx bitnami/nginx
</code></pre></div>
<div class="highlight"><pre><span></span><code>helm fetch --untar bitnami/nginx

ls nginx/
vim nginx/values.yaml
<span class="c1"># serviceType: LoadBalancer --&gt; NodePort</span>
helm upgrade mynginx ./nginx

kubectl get svc
</code></pre></div>
<h3 id="clean-up">Clean up<a class="headerlink" href="#clean-up" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>helm delete mynginx
</code></pre></div>


</section>

</div> <!-- end of page-inner -->
</div> <!-- end of page-wrapper -->

</div> <!-- end of body-inner -->

</div> <!-- end of book-body -->
<script src="../js/main.js"></script>
<script src="../js/gitbook.min.js"></script>
<script src="../js/theme.min.js"></script>
</body>
</html>